organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_brain_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "geneontology_Cellular_Component"           # Database: Human Cell Landscape
)
hsa_brain_top10p_CC <- CC_brain |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Cerebellum
hsa_cerebellum_top10p <- mRNA_expression_CDS |>
mutate(rank = percent_rank(cerebellum_small)) |>
filter(rank >= 0.9) |>
row.names()
# Run     WebGestaltR for Human Cell Landscape enrichment
CC_cerebellum <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_cerebellum_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "geneontology_Cellular_Component"           # Database: Human Cell Landscape
)
hsa_cerebellum_top10p_CC <- CC_cerebellum |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Heart
hsa_heart_top10p <- mRNA_expression_CDS |>
mutate(rank = percent_rank(heart_small)) |>
filter(rank >= 0.9) |>
row.names()
# Run     WebGestaltR for Human Cell Landscape enrichment
CC_heart <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_heart_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "geneontology_Cellular_Component"           # Database: Human Cell Landscape
)
hsa_heart_top10p_CC <- CC_heart |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Kidney
hsa_kidney_top10p <- mRNA_expression_CDS |>
mutate(rank = percent_rank(kidney_small)) |>
filter(rank >= 0.9) |>
row.names()
# Run     WebGestaltR for Human Cell Landscape enrichment
CC_kidney <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_kidney_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "geneontology_Cellular_Component"           # Database: Human Cell Landscape
)
hsa_kidney_top10p_CC <- CC_kidney |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Association between sequencing depth and R-squared
count_r_squared <- read_table("datasets/read_counts_and_r-squared.tab")
cor.test(count_r_squared$count/count_r_squared$Genome.Mb, count_r_squared$Rsquared)
cor.test(count_r_squared$Count.over.25nt/count_r_squared$Genome.Mb, count_r_squared$Rsquared)
count_r_squared_notestis <- count_r_squared |>
filter(tissue != "testis")
cor.test(count_r_squared_notestis$Count.over.25nt/count_r_squared_notestis$Genome.Mb, count_r_squared_notestis$Rsquared)
# 0.6629908, p 0.02618
cor.test(count_r_squared_notestis$count/count_r_squared_notestis$Genome.Mb, count_r_squared_notestis$Rsquared)
# KEGG annotation top 10%
# Brain
# Run     WebGestaltR for Human Cell Landscape enrichment
KEGG_brain <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_brain_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "pathway_KEGG"           # Database: Human Cell Landscape
)
hsa_brain_top10p_KEGG <- KEGG_brain |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Cerebellum
# Run     WebGestaltR for Human Cell Landscape enrichment
KEGG_cerebellum <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_cerebellum_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "pathway_KEGG"           # Database: Human Cell Landscape
)
hsa_cerebellum_top10p_KEGG <- KEGG_cerebellum |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Heart
# Run     WebGestaltR for Human Cell Landscape enrichment
KEGG_heart <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_heart_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "pathway_KEGG"           # Database: Human Cell Landscape
)
hsa_heart_top10p_KEGG <- KEGG_heart |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Kidney
# Run     WebGestaltR for Human Cell Landscape enrichment
KEGG_kidney <- WebGestaltR(
organism = "hsapiens",                    # Human species
enrichMethod = "ORA",                     # Over-Representation Analysis
interestGene = hsa_kidney_top10p,                # Input gene list
interestGeneType = "genesymbol",          # Gene type (e.g., genesymbol, entrezgene, etc.)
referenceGene = row.names(mRNA_expression_CDS),         # Background gene list
referenceGeneType = "genesymbol",         # Background gene type
fdrMethod = "BH",                         # Multiple testing correction (Benjamini-Hochberg)
isOutput = FALSE,                          # Save results to file
enrichDatabase = "pathway_KEGG"           # Database: Human Cell Landscape
)
hsa_kidney_top10p_KEGG <- KEGG_kidney |>
arrange(FDR) |>
slice_head(n = 3) |>
dplyr::select(description, enrichmentRatio, FDR)
# Output table annotation
output_annotation_table <- rbind(hsa_brain_top10p_KEGG,
hsa_cerebellum_top10p_KEGG,
hsa_heart_top10p_KEGG,
hsa_kidney_top10p_KEGG,
hsa_brain_top10p_CC,
hsa_cerebellum_top10p_CC,
hsa_heart_top10p_CC,
hsa_kidney_top10p_CC) |>
mutate(tissue = rep(c(rep("brain", 3),
rep("cerebellum",3),
rep("heart",3),
rep("kidney",3)),2)) |>
mutate(database = c(rep("KEGG", 12), rep("Cellular Component (GO)", 12)))
write.table(output_annotation_table, file = "plots/table_annotation_10p.tab", sep = "\t", quote = FALSE, row.names = FALSE)
## Relative coverage for transcript section 5UTR, CDS, 3UTR.
# Load files with CDS/UTR read mappings
untar("datasets/hsa_mapping_UTR_CDS.tar.gz",
exdir = tempdir())
Brawand_CDS <- read.table(file.path(tempdir(),
"GSE30352_Brawand",
"Brawand_mRNA_CDS.tab"),
header = TRUE,
sep = "\t")[,-c(8,11)] # Subset 4 datasets from first analysis
Brawand_UTR5 <- read.table(file.path(tempdir(),
"GSE30352_Brawand",
"Brawand_mRNA_UTR5.tab"),
header = TRUE,
sep = "\t")[,-c(8,11)] # Subset 4 datasets from first analysis
Brawand_UTR3 <- read.table(file.path(tempdir(),
"GSE30352_Brawand",
"Brawand_mRNA_UTR3.tab"),
header = TRUE,
sep = "\t")[,-c(8,11)] # Subset 4 datasets from first analysis
Meunier_CDS <- read.table(file.path(tempdir(),
"GSE40499_Meunier",
"Meunier_mRNA_CDS.tab"),
header = TRUE,
sep = "\t")[,-11] # Subset 4 datasets from first analysis
Meunier_UTR5 <- read.table(file.path(tempdir(),
"GSE40499_Meunier",
"Meunier_mRNA_UTR5.tab"),
header = TRUE,
sep = "\t")[,-11] # Subset 4 datasets from first analysis
Meunier_UTR3 <- read.table(file.path(tempdir(),
"GSE40499_Meunier",
"Meunier_mRNA_UTR3.tab"),
header = TRUE,
sep = "\t")[,-11] # Subset 4 datasets from first analysis
# Total reads and lengths
Brawand_CDS_total <- Brawand_CDS[,c(6:10)] |> colSums()
Brawand_UTR5_total <- Brawand_UTR5[,c(6:10)] |> colSums()
Brawand_UTR3_total <- Brawand_UTR3[,c(6:10)] |> colSums()
Meunier_CDS_total <- Meunier_CDS[,c(6:10)] |> colSums()
Meunier_UTR5_total <- Meunier_UTR5[,c(6:10)] |> colSums()
Meunier_UTR3_total <- Meunier_UTR3[,c(6:10)] |> colSums()
# BRAWAND; summary tables
Brawand_total <- rbind(Brawand_CDS_total,
Brawand_UTR5_total,
Brawand_UTR3_total)
# Counts per kilobase
Brawand_count_kb <- t(Brawand_total[,c(2:5)]*1000/Brawand_total[,1])
# log2FC relative to CDS
Brawand_log2_CDS <- log2(Brawand_count_kb/Brawand_count_kb[,1])
# MEUNIER; summary tables
Meunier_total <- rbind(Meunier_CDS_total,
Meunier_UTR5_total,
Meunier_UTR3_total)
Meunier_count_kb <- t(Meunier_total[,c(2:5)]*1000/Meunier_total[,1])
Meunier_log2_CDS <- log2(Meunier_count_kb/Meunier_count_kb[,1])
# Plots
# Brawand
plot_B_UTR <- tibble(dataset = rep(c(1:4), 2),
UTR = c(rep("3' UTR", 4), rep("5' UTR", 4)),
log2FC = c(Brawand_log2_CDS[,2], Brawand_log2_CDS[,3])) |>
ggplot(aes(y = log2FC,
x = UTR)) +
geom_boxplot() +
scale_x_discrete(limits = c("5' UTR", "3' UTR")) +
geom_point(aes(y = log2FC,
x = UTR)) +
geom_line(aes(group = dataset), alpha = 0.5, col = "grey") +
geom_hline(yintercept=0) +
labs(y = "log2 fold-change UTR/CDS",
x = "") +
ylim(c(-2,3)) +
theme_bw()
# Meunier
plot_M_UTR <- tibble(dataset = rep(c(1:4), 2),
UTR = c(rep("3' UTR", 4), rep("5' UTR", 4)),
log2FC = c(Meunier_log2_CDS[,2], Meunier_log2_CDS[,3])) |>
ggplot(aes(y = log2FC,
x = UTR)) +
scale_x_discrete(limits = c("5' UTR", "3' UTR")) +
geom_boxplot() +
geom_point(aes(y = log2FC,
x = UTR)) +
geom_line(aes(group = dataset), alpha = 0.5, col = "grey") +
geom_hline(yintercept=0) +
labs(y = "",
x = "") +
ylim(c(-2,3)) +
theme_bw()
# Brain first and cerebellum after are the ones more similar to total RNA!
ggsave((plot_B_UTR + plot_M_UTR) + plot_annotation(tag_levels = 'A'), file = "plots/Figure_UTRs.png")
plot_B_UTR + plot_M_UTR) + plot_annotation(tag_levels = 'A')
(plot_B_UTR + plot_M_UTR) + plot_annotation(tag_levels = 'A')
library(pheatmap)
library(patchwork)
library(gprofiler2)
library(tidyverse)
# Bioconductor
library(edgeR)
BiocManager::install("edgeR")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("edgeR")
library(pheatmap)
library(patchwork)
library(gprofiler2)
library(tidyverse)
# Bioconductor
library(edgeR)
library(DESeq2)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
source("~/Downloads/CDS_from_sRNAseq/breast_cancer_dge.R", echo = TRUE)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("EnhancedVolcano")
R.version.string
BiocManager::version()
if (!requireNamespace("remotes", quietly = TRUE))
install.packages("remotes")
remotes::install_github("kevinblighe/EnhancedVolcano")
source("~/Downloads/CDS_from_sRNAseq/breast_cancer_dge.R", echo = TRUE)
volcano_mRNA
# plots
volcano_mRNA <- EnhancedVolcano(resmR,
lab = paste0('italic(', (resmR), ')'),
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3)
# plots
gene_labels <- paste0('italic(', (resmR), ')')
# plots
gene_names <- as.character(rownames(res))
# plots
gene_names <- as.character(rownames(resmR))
gene_labels <- paste0('italic(', (gene_names), ')')
volcano_mRNA <- EnhancedVolcano(resmR,
lab = gene_labels,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3)
volcano_mRNA <- EnhancedVolcano(resmR,
lab = gene_labels,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3,
parseLabels = TRUE)
# plots
gene_names <- as.character(rownames(resmR))
gene_labels <- paste0('italic(', (gene_names), ')')
volcano_mRNA <- EnhancedVolcano(resmR,
lab = gene_labels,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3,
parseLabels = TRUE)
volcano_mRNA
ggsave(volcano_mRNA, file = "plots/volcano_mRNA.png")
# plots
gene_names <- as.character(rownames(resmR))
gene_labels <- paste0('italic(', (gene_names), ')')
volcano_mRNA <- EnhancedVolcano(resmR,
lab = gene_labels,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3,
parseLabels = TRUE)
ggsave(volcano_mRNA, file = "plots/volcano_mRNA.png")
volcano_mRNA <- EnhancedVolcano(resmR,
lab = gene_labels,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3,
parseLabels = TRUE)
ggsave(volcano_mRNA, file = "plots/volcano_mRNA.png")
volcano_mRNA
ggsave(volcano_mRNA, file = "plots/volcano_mRNA.png")
volcano_mRNA <- EnhancedVolcano(resmR,
lab = gene_labels,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01,
xlim = c(-5,5),
labSize = 3,
parseLabels = TRUE)
volcano_mRNA
ggsave(volcano_mRNA, file = "plots/volcano_mRNA.png")
recall_plot
recall_plot <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% custom_order) |>
mutate(tr = factor(tr, levels = custom_order)) |>
arrange(tr) |>
ggplot(aes(x = tr, y = log2FoldChange)) +
geom_col() +
coord_flip() +  # ‚Üê make it horizontal
theme_minimal() +
labs(x = "Gene", y = expression(log[2]~"Fold Change"), title = "Horizontal Bar Plot")
recall_plot
recall_plot <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% custom_order) |>
mutate(tr = factor(tr, levels = custom_order)) |>
arrange(tr) |>
ggplot(aes(x = tr, y = log2FoldChange)) +
geom_col() +
coord_flip() +  # make it horizontal
theme_minimal() +
labs(
x = NULL,  # we will use axis.text.y for gene names
y = expression(log[2]~"Fold Change"),
title = "Horizontal Bar Plot"
) +
scale_y_continuous() +
theme(
axis.text.y = element_text(face = "italic")  # italics for gene names
)
recall_plot
ggsave(recall_plot, file = "plots/reacall_plot.png")
library(ggplot2)
library(patchwork)
# Bioconductor
library(edgeR)
# TARGET ANALYSIS
# MirTarBase
targets_MTB <- read.table("datasets/mirtarbase_hsa_9.tab.gz")
# Small RNA expression mapped to all genes
mRNA_expression <- read.table("datasets/Meunier_mRNA.tab.gz", header = TRUE, row.names = 1)
mRNA_expression <- mRNA_expression[,-c(1:5)]
# Small RNAs mapped to microRNAs
microRNA_expression <- read.table("datasets/Meunier_microRNA.tab.gz", header = TRUE, row.names = 1)
microRNA_expression <- microRNA_expression[,-c(1:5)]
# Remove genes/miRNAs with zero reads in all samples
mRNA_expression <- mRNA_expression[which(rowSums(mRNA_expression)!=0),]
microRNA_expression <- microRNA_expression[which(rowSums(microRNA_expression)!=0),]
# mRNAs and microRNA with target information, subset
# remove those inteaction reported for human annotated microRNAs
microRNAs_MTB <- unique(targets_MTB[,1][grepl("^hsa-",targets_MTB[,1])])
mRNA_MTB <- unique(targets_MTB[,2][grepl("^hsa-",targets_MTB[,1])])
# Only mRNs/microRNAs in all sets
microRNA_expression <- microRNA_expression[names(which(table(c(row.names(microRNA_expression),microRNAs_MTB))==2)),]
mRNA_expression <- mRNA_expression[names(which(table(c(row.names(mRNA_expression),mRNA_MTB))==2)),]
# Normalization, expression levels. VOOM TRANSFORATION
mRNA_expression_voom <- voom(mRNA_expression)$E
microRNA_expression_voom <- voom(microRNA_expression)$E
# # Uncomment to run from scratch, otherwise, using pre-computed correlations
# # Correlations table
# correlations_table <- matrix(nrow=nrow(mRNA_expression_voom), ncol = 0)
# total <- length(rownames(microRNA_expression_voom))
# for(i in 1:total)
# {
#   print(paste("MicroRNA ", i, " out of ", total, sep = ""))
#   mycor <- function(input){return(cor(as.numeric(input),as.numeric(microRNA_expression_voom[i,]), method = "spearman"))}
#   correlations_table <- cbind(correlations_table, apply(mRNA_expression_voom,1,mycor))
# }
# correlations.df <- as.data.frame(correlations_table)
# colnames(correlations.df) <- rownames(microRNA_expression_voom)
# save(correlations.df, file = "datasets/correlations.Rdata")
load("datasets/correlations.Rdata")
# Filter targets for only those in the expression dataset
targets_MTB_clean <- targets_MTB[targets_MTB$V1 %in% colnames(correlations.df),]
targets_MTB_clean <- targets_MTB_clean[targets_MTB_clean$V2 %in% rownames(correlations.df),]
# Correlation between target and non-target pairs
corr_targets <- vector()
correlations.df_notargets <- correlations.df
for(i in 1:nrow(targets_MTB_clean)){
if((i %% 1000) == 0){
cat(paste(i, " out of ", nrow(targets_MTB_clean), " (", round((i/nrow(targets_MTB_clean)*100), digits = 0), "%)\r", sep = ""))
}
corr_targets <- c(corr_targets, correlations.df[targets_MTB_clean[i,2],targets_MTB_clean[i,1]])
correlations.df_notargets[targets_MTB_clean[i,2],targets_MTB_clean[i,1]] <- 1000 # 1000 can't result from cor function
}
correlations.df_notargets.unlisted <- unlist(correlations.df_notargets)
corr_non_targets <- as.vector(correlations.df_notargets.unlisted)
corr_non_targets <- corr_non_targets[corr_non_targets < 1000] # Remove values from target interactions
corr_comparison <- data.frame(corr = c(corr_targets, corr_non_targets), targ = c(rep("target", length(corr_targets)), rep("non-target", length(corr_non_targets))))
# MW TEST
wilcox.test(corr_targets, corr_non_targets, alternative = "less")
# W = 2.1545e+12, p-value < 2.2e-16
# remove NAs
corr_targets <- corr_targets[!is.na(corr_targets)]
corr_non_targets <- corr_non_targets[!is.na(corr_non_targets)]
# Smoothing function
smoothing_exp_correl <- function (correl = seq(-1, 1, 0.1), w = 0.1, s = 0.1) {
size <- length(correl)
mids <- seq(-1+(w/2), 1-(w/2), s)
counts <- rep(0,length(mids))
for(i in 1:length(correl)){
if(correl[i] != 1){
which_bin <- which((correl[i] >= mids-(w/2)) & (correl[i] < mids+(w/2)))
counts[which_bin] <- counts[which_bin] + 1
} else {
counts[length(counts)] <- counts[length(counts)] + 1
}
}
return(counts/size)
}
# Smooth
corr_targets_smooth_s02_w02 <- smoothing_exp_correl(corr_targets, s = 0.02, w = 0.2)
corr_non_targets_smooth_s02_w02 <- smoothing_exp_correl(corr_non_targets, s = 0.02, w = 0.2)
MTB_corrs_s02_w02 <- log2(corr_targets_smooth_s02_w02/corr_non_targets_smooth_s02_w02)
data.corrs.s02.w02 <- data.frame(mid = seq(-0.9, 0.9, 0.02), corr = MTB_corrs_s02_w02)
# Plot
plot_MTB <- ggplot(data = data.corrs.s02.w02, aes(x = mid, y = corr, col = 'darkred'))+
geom_line() +
geom_hline(yintercept=0, linetype="solid", color = "black") +
geom_vline(xintercept=0, linetype="dashed", color = "black") +
xlab("Correlation (Pearson's coefficient)") +
ylab("log2(target/non-target)") +
theme_bw() +
theme(legend.position="none")
plot_MTB
ggsave(plot_MTB , file = "plots/Figure_3.png")
q()
plot_MTB
# Plot
plot_MTB <- ggplot(data = data.corrs.s02.w02, aes(x = mid, y = corr, col = 'darkred'))+
geom_line() +
geom_hline(yintercept=0, linetype="solid", color = "black") +
geom_vline(xintercept=0, linetype="dashed", color = "black") +
xlab("Correlation (Pearson's coefficient)") +
ylab(expression(log[2]*"(target/non-target)")) +
theme_bw() +
theme(legend.position="none")
plot_MTB
ggsave(plot_MTB , file = "plots/Figure_3.png")
