not_in_SV_pn_in_TB <- not_in_SV_pn[not_in_SV_pn$tar %in% in_MTB_pn$tar,]
not_in_SV_pn_not_in_TB <- not_in_SV_pn[!(not_in_SV_pn$tar %in% in_MTB_pn$tar),]
in_SV_nn_in_TB <- in_SV_nn[in_SV_nn$tar %in% in_MTB_nn$tar,]
in_SV_nn_not_in_TB <- in_SV_nn[!(in_SV_nn$tar %in% in_MTB_nn$tar),]
not_in_SV_nn_in_TB <- not_in_SV_nn[not_in_SV_nn$tar %in% in_MTB_nn$tar,]
not_in_SV_nn_not_in_TB <- not_in_SV_nn[!(not_in_SV_nn$tar %in% in_MTB_nn$tar),]
in_SV_pp_in_TB <- in_SV_pp[in_SV_pp$tar %in% in_MTB_pp$tar,]
in_SV_pp_not_in_TB <- in_SV_pp[!(in_SV_pp$tar %in% in_MTB_pp$tar),]
not_in_SV_pp_in_TB <- not_in_SV_pp[not_in_SV_pp$tar %in% in_MTB_pp$tar,]
not_in_SV_pp_not_in_TB <- not_in_SV_pp[!(not_in_SV_pp$tar %in% in_MTB_pp$tar),]
in_SV_np_in_TB <- in_SV_np[in_SV_np$tar %in% in_MTB_np$tar,]
in_SV_np_not_in_TB <- in_SV_np[!(in_SV_np$tar %in% in_MTB_np$tar),]
not_in_SV_np_in_TB <- not_in_SV_np[not_in_SV_np$tar %in% in_MTB_np$tar,]
not_in_SV_np_not_in_TB <- not_in_SV_np[!(not_in_SV_np$tar %in% in_MTB_np$tar),]
# Enrichment in targets (predicted) for log fold configurations against MTB
LOR_pn_nn <- log((nrow(in_SV_pn_in_TB)*nrow(in_SV_nn_not_in_TB))/(nrow(in_SV_pn_not_in_TB)*nrow(in_SV_nn_in_TB)))
SEM_pn_nn <- sqrt(nrow(in_SV_pn_in_TB)^(-1) + nrow(in_SV_nn_not_in_TB)^(-1) + nrow(in_SV_pn_not_in_TB)^(-1) + nrow(in_SV_nn_in_TB)^(-1))
ZSC_pn_nn <- LOR_pn_nn / SEM_pn_nn
PVL_pn_nn <- pnorm(ZSC_pn_nn, mean = 0, sd = 1, lower.tail = FALSE) # One-tailed
#
# np vs pp
LOR_np_pp <- log((nrow(in_SV_np_in_TB)*nrow(in_SV_pp_not_in_TB))/(nrow(in_SV_np_not_in_TB)*nrow(in_SV_pp_in_TB)))
SEM_np_pp <- sqrt(nrow(in_SV_np_in_TB)^(-1) + nrow(in_SV_pp_not_in_TB)^(-1) + nrow(in_SV_np_not_in_TB)^(-1) + nrow(in_SV_pp_in_TB)^(-1))
ZSC_np_pp <- LOR_np_pp / SEM_np_pp
PVL_np_pp <- pnorm(ZSC_np_pp, mean = 0, sd = 1, lower.tail = FALSE) # One-tailed
#
# np vs pp
LOR_nn_pp <- log((nrow(in_SV_nn_in_TB)*nrow(in_SV_pp_not_in_TB))/(nrow(in_SV_nn_not_in_TB)*nrow(in_SV_pp_in_TB)))
SEM_nn_pp <- sqrt(nrow(in_SV_nn_in_TB)^(-1) + nrow(in_SV_pp_not_in_TB)^(-1) + nrow(in_SV_nn_not_in_TB)^(-1) + nrow(in_SV_pp_in_TB)^(-1))
ZSC_nn_pp <- LOR_nn_pp / SEM_nn_pp
PVL_nn_pp <- pnorm(ZSC_nn_pp, mean = 0, sd = 1, lower.tail = FALSE) # One-tailed
out_table <- tibble(numerator = c("miR up; tr down", "miR down; tr up", "miR down tr down"),
denominator = c("miR down; tr down", "miR up; tr up", "miR up tr up"),
odds_ratio = c(exp(1)^LOR_pn_nn, exp(1)^LOR_np_pp, exp(1)^LOR_nn_pp),
z_score = c(ZSC_pn_nn, ZSC_np_pp, ZSC_nn_pp),
p_value = c(PVL_pn_nn, PVL_np_pp, PVL_nn_pp))
write_tsv(out_table, file = "plots/target_enrichment_BCa.tab")
# From paper associated to datasets
# https://bmccancer.biomedcentral.com/articles/10.1186/s12885-019-5300-6
# To assess the physiological and pathological significance of the observed
# down-regulation of miR-10b, we measured by qRTPCR the mRNA levels of 15
# previously validated targets of miR-10b (primer sequences in
# Additional file 1: Table S2) based on the validated miRNA target database,
# miRTarBase [25], in all the RNA samples from our 83-patient cohort. We
# identified that miR-10b levels showed a significant inverse correlation with
# target mRNA levels in at least one subset of samples (the tumor or the benign)
# for 4 out of 15 genes tested: MAPRE1, PIEZO1, SRSF1 and TP53 (Fig. 3a-c).
# Note, not successful: BCL2L11, BDNF, CDKN1A, CDKN2A, HOXD10, KLF4, NCOR2,
# PAX6, PPARa, PTEN, TRA2B
gold <- c(rep(1,4), rep(0, 10))
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > 0, 1, 0)) |>
unlist() |>
as.vector()
# Check expression of miR-10a-5p
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
# Preprare output
output_lines <- list(
TP = TP, FP = FP, TN = TN, FN = FN,
recall = recall, FPR = FPR,
precision = precision, accuracy = accuracy
)
formatted_lines <- sapply(names(output_lines), function(name) {
paste0(name, " = ", output_lines[[name]])
})
# Write output
writeLines(formatted_lines, "plots/mir10-accuracy_output.txt")
# Plot
custom_order <- c("BCL2L11", "BDNF",
"CDKN1A", "CDKN2A", "HOXD10", "KLF4", "NCOR2", "PAX6",
"PPARA", "PTEN", "TRA2B",
"TP53","MAPRE1", "PIEZO1", "SRSF1")
recall_plot <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% custom_order) |>
mutate(tr = factor(tr, levels = custom_order)) |>
arrange(tr) |>
ggplot(aes(x = tr, y = log2FoldChange)) +
geom_col() +
coord_flip() +  # make it horizontal
theme_minimal() +
labs(
x = NULL,  # we will use axis.text.y for gene names
y = expression(log[2]~"Fold Change"),
title = "Horizontal Bar Plot"
) +
scale_y_continuous() +
theme(
axis.text.y = element_text(face = "italic")  # italics for gene names
)
ggsave(recall_plot, file = "plots/reacall_plot.png")
# exit
q()
gold <- c(rep(1,4), rep(0, 10))
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > 0, 1, 0)) |>
unlist() |>
as.vector()
# Check expression of miR-10a-5p
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
recall
FPR
precision
accuracy
# Test reviewer fold
gold <- c(rep(1,4), rep(0, 10))
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > 0, 1, 0)) |>
unlist() |>
as.vector()
# Check expression of miR-10a-5p
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
recall
FPR
precision
accuracy
# Test reviewer fold
gold <- c(rep(1,4), rep(0, 10))
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > 1, 1, 0)) |>
unlist() |>
as.vector()
# Check expression of miR-10a-5p
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
recall
FPR
precision
accuracy
# Test reviewer fold
gold <- c(rep(1,4), rep(0, 10))
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > 2, 1, 0)) |>
unlist() |>
as.vector()
# Check expression of miR-10a-5p
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
recall
FPR
precision
accuracy
seq(0,2,0.1)
for(threshold in seq(0,2,0.1)){
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > threshold, 1, 0)) |>
unlist() |>
as.vector()
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
outvector <- c(threshold, recall, FPR, preceission, accuracy)
}
for(threshold in seq(0,2,0.1)){
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > threshold, 1, 0)) |>
unlist() |>
as.vector()
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
outvector <- c(threshold, recall, FPR, precission, accuracy)
}
for(threshold in seq(0,2,0.1)){
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > threshold, 1, 0)) |>
unlist() |>
as.vector()
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
outvector <- c(threshold, recall, FPR, precision, accuracy)
}
data.frame(threshold = numeric(), recall = numeric(), FPR = numeric(), precision = numeric(), accuracy = numeric())
all_values <- data.frame(threshold = numeric(), recall = numeric(), FPR = numeric(), precision = numeric(), accuracy = numeric())
for(threshold in seq(0,2,0.1)){
test <- resmR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("MAPRE1", "PIEZO1", "SRSF1", "TP53",
"BCL2L11", "BDNF",  "CDKN1A", "CDKN2A",
"HOXD10", "KLF4", "NCOR2",
"PPARA", "PTEN", "TRA2B")) |> # PAX6 removed as expression was not detected
select(log2FoldChange) |>
mutate(log2FoldChange = ifelse(log2FoldChange > threshold, 1, 0)) |>
unlist() |>
as.vector()
resmiR |>
as.data.frame() |>
rownames_to_column('tr') |>
as_tibble() |>
filter(tr %in% c("hsa-miR-10b-5p"))
TP = length(which((test + gold) == 2))
FP = length(which((test[5:14] + gold[5:14]) == 1))
TN = length(which((test + gold) == 0))
FN = length(which((test[1:4] + gold[1:4]) == 1))
recall <- TP/(TP+FN)
FPR <- FP/(FP+TN)
precision <- TP/(TP+FP)
accuracy <- (TP+TN)/(TP+TN+FP+FN)
outvector <- c(threshold, recall, FPR, precision, accuracy)
all_values <- rbind(all_values, outvector)
}
all_values
colnames(all_values) <- c(threshold, recall, FPR, precision, accuracy)
all_values
colnames(all_values) <- c(threshold, recall, FPR, precision, accuracy)
# exit
q()
all_values
c(threshold, recall, FPR, precision, accuracy)
colnames(all_values) <- c("threshold", "recall", "FPR", "precision", "accuracy")
all_values
# Plot
all_values |>
ggplot(aes(x = threshold,
y = recall))
# Plot
all_values |>
ggplot(aes(x = threshold,
y = recall)) +
geom_line()
# Plot
all_values |>
ggplot(aes(x = threshold,
y = recall)) +
geom_line() +
theme_minimal()
# Plot
all_values |>
pivot_longer()
?pivot_longer
# Plot
all_values |>
pivot_longer(cols = c("threshold", "recall", "FPR", "precision", "accuracy"),
names_to = statistic)
# Plot
all_values |>
pivot_longer(cols = c("threshold", "recall", "FPR", "precision", "accuracy"),
names_to = "statistic")
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic")
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR")
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = recall)) +
geom_line() +
theme_minimal()
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
theme_minimal()
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
y_lab("2") +
theme_minimal()
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
labs(x = "2") +
theme_minimal()
expression
a
# Plot
all_values |>
)
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
labs(x = "2",
y = expression(log[2]*"fold-change threshold")) +
theme_minimal()
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
labs(x = "2",
y = expression(log[2]*"(fold-change) threshold")) +
theme_minimal()
# Plot
all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
labs(Value = "2",
x = expression(log[2]*"(fold-change) threshold")) +
theme_minimal()
# Plot
recall_plot_2 <- all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
labs(Value = "2",
x = expression(log[2]*"(fold-change) threshold")) +
theme_minimal()
ggsave(recall_plot_2, file = "plots/reacall_plot_2.png")
# Plot
recall_plot_2 <- all_values |>
pivot_longer(cols = c("recall", "FPR", "precision", "accuracy"),
names_to = "statistic") |>
filter(statistic != "FPR") |>
ggplot(aes(x = threshold,
y = value,
color = statistic)) +
geom_line() +
labs(y = "Value",
x = expression(log[2]*"(fold-change) threshold")) +
theme_minimal()
ggsave(recall_plot_2, file = "plots/reacall_plot_2.png")
